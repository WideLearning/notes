# expanding subspace minimization
From [[conjugate directions method]]
$\physics$
## Statement
Suppose $x_{[n]}$ is generated by [[conjugate directions method]]. Then:
1. $\forall i, k \in [n], i < k. \ev{r_{k}, p_{i}} = 0$
2. $\forall k \in [n]. x_{k} = \arg\min\limits_{x_{1} + \ev{p_{[k - 1]}}} \ev{\frac{1}{2}Ax - b, x}$

## Proof
1. 
For $i = k - 1$ we have it by constuction:
$r_{k} = Ax_{k} - b$, $x_{k} = x_{k-1} + \alpha_{k-1}p_{k-1}$, $\alpha_{k-1} = -\frac{\ev{r_{k-1}, p_{k-1}}}{\ev{Ap_{k-1}, p_{k-1}}}$
$$\begin{split}
\ev{r_{k}, p_{k-1}}
&= \ev{A\qty(x_{k-1} + \alpha_{k-1} p_{k-1}) - b, p_{k-1}}\\
&= \ev{r_{k-1} + \alpha_{k-1} A p_{k-1}, p_{k-1}}\\
&= \ev{r_{k-1}, p_{k-1}} - \frac{\ev{r_{k-1}, p_{k-1}}}{\ev{Ap_{k-1}, p_{k-1}}} \ev{A p_{k-1}, p_{k-1}}\\
&= 0
\end{split}$$
For $i \in [k-2]$, by induction and because $p_{[k]}$ are [[conjugate system]]:
$$\begin{split}
\ev{r_{k}, p_{i}} 
&= \ev{r_{k-1} + \alpha_{k-1}Ap_{k-1}, p_{i}}\\
&= \ev{\alpha_{k-1}Ap_{k-1}, p_{i}}\\
&= \alpha_{k-1} \ev{p_{k-1}, p_{i}}\\
&= 0
\end{split}$$
2. 
Denote $\phi(x) = \ev{\frac{1}{2}Ax - b, x}$, $\nabla \phi(x) = Ax - b$ (see [[linear equations and quadratic minimization are equivalent]]). Also, denote $h(c) = \phi(x_{1} + \sum\limits_{i\in [k-1]} c_{i}p_{i})$. And let $x_{k} = x_{1} + \sum\limits c'_{i}p_{i}$.
$$\forall i < k. \pdv{h(c')}{c_{i}} = \dv{\phi(x_{k})}{x}\pdv{x}{c_{i}} = (\nabla \phi(x_{k}))^{T}p_{i} = r_{k}^{T}p_{i} = 0$$
So $\dd{h}(c') = 0$. Because positive quadratic form being restricted on any subspace is still positive, we have $\dd{}^{2}h(c') > 0$, so it is a minimum.